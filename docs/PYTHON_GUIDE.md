# ğŸ Hantubot íŒŒì´ì¬ ì‹¤ì „ ê°€ì´ë“œ

> **ì½”ë“œì˜ êµ¬ì¡°ë¥¼ ì´í•´í•˜ê³ , ë‚˜ë§Œì˜ ì „ëµì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.**

---

## ğŸ“‹ ëª©ì°¨

1. [íŒŒì´ì¬ í•µì‹¬ ë¬¸ë²• ë³µìŠµ](#1-íŒŒì´ì¬-í•µì‹¬-ë¬¸ë²•-ë³µìŠµ)
2. [Hantubot ì½”ë“œ êµ¬ì¡° ë¶„ì„](#2-hantubot-ì½”ë“œ-êµ¬ì¡°-ë¶„ì„)
3. [ë‚˜ë§Œì˜ ì „ëµ ë§Œë“¤ê¸°](#3-ë‚˜ë§Œì˜-ì „ëµ-ë§Œë“¤ê¸°)

---

## 1. íŒŒì´ì¬ í•µì‹¬ ë¬¸ë²• ë³µìŠµ

### 1.1 Classì™€ Self
Hantubotì€ ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°(OOP)ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. `class`ì™€ `self`ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

```python
class Strategy:
    def __init__(self, name):
        self.name = name  # 'ë‚˜'ì˜ ì´ë¦„
        self.cash = 0     # 'ë‚˜'ì˜ í˜„ê¸ˆ
    
    def deposit(self, amount):
        self.cash += amount  # 'ë‚˜'ì˜ í˜„ê¸ˆ ì¦ê°€
```

- **Class**: ì„¤ê³„ë„ (ë¶•ì–´ë¹µ í‹€)
- **Object**: ì‹¤ì œ ë§Œë“¤ì–´ì§„ ê²ƒ (ë¶•ì–´ë¹µ)
- **self**: ì¸ìŠ¤í„´ìŠ¤ ìì‹ ì„ ê°€ë¦¬í‚¤ëŠ” ë§. "ë‚˜ì˜ ë³€ìˆ˜", "ë‚˜ì˜ í•¨ìˆ˜"ë¥¼ ì“¸ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### 1.2 ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë° (Async/Await)
ì£¼ì‹ ì‹œì¥ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì›€ì§ì´ë¯€ë¡œ, Hantubotì€ ë¹„ë™ê¸°(`asyncio`) ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
async def check_price():
    price = await broker.get_current_price("005930")  # ê°€ê²© ì˜¬ ë•Œê¹Œì§€ ë‹¤ë¥¸ ì¼ í•˜ë©° ëŒ€ê¸°
    print(price)
```

- **async def**: ë¹„ë™ê¸° í•¨ìˆ˜ ì •ì˜
- **await**: ê²°ê³¼ê°€ ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼ (ê·¸ ë™ì•ˆ ë‹¤ë¥¸ ì‘ì—… ì²˜ë¦¬ ê°€ëŠ¥)

---

## 2. Hantubot ì½”ë“œ êµ¬ì¡° ë¶„ì„

### 2.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
hantubot/
â”œâ”€â”€ core/           # [ì—”ì§„] ë´‡ì˜ ì‹¬ì¥. ìŠ¤ì¼€ì¤„ë§ ë° ì „ì²´ íë¦„ ê´€ë¦¬
â”œâ”€â”€ strategies/     # [ë‘ë‡Œ] ë§¤ë§¤ ì „ëµë“¤ì´ ëª¨ì—¬ìˆëŠ” ê³³
â”œâ”€â”€ execution/      # [ì†ë°œ] ì‹¤ì œ ì£¼ë¬¸ì„ ë‚´ê³  ì²´ê²°ì„ í™•ì¸í•˜ëŠ” ê³³
â”œâ”€â”€ reporting/      # [ì…] ì•Œë¦¼ì„ ë³´ë‚´ê³  ë¦¬í¬íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ê³³
â””â”€â”€ gui/            # [ì–¼êµ´] ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (PySide6)
```

### 2.2 í•µì‹¬ ë°ì´í„° íë¦„
1. **Engine**ì´ ì‹œê°„ì— ë§ì¶° ì „ëµ(`Strategy`)ì„ ê¹¨ì›ë‹ˆë‹¤.
2. **Strategy**ëŠ” ì‹œì¥ ë°ì´í„°ë¥¼ ë¶„ì„í•´ ì‹ í˜¸(`Signal`)ë¥¼ ë§Œë“­ë‹ˆë‹¤.
   - ì˜ˆ: `{"symbol": "005930", "side": "buy", "quantity": 10}`
3. **OrderManager**ëŠ” ì‹ í˜¸ë¥¼ ê²€ì¦í•˜ê³ (ì˜ˆìˆ˜ê¸ˆ í™•ì¸ ë“±) **Broker**ì—ê²Œ ì£¼ë¬¸ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
4. **Broker**ëŠ” KIS APIë¥¼ í†µí•´ ì‹¤ì œ ì£¼ë¬¸ì„ ì „ì†¡í•©ë‹ˆë‹¤.
5. ì²´ê²°ì´ ì™„ë£Œë˜ë©´ **Portfolio**ê°€ ì”ê³ ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , **Notifier**ê°€ ë””ìŠ¤ì½”ë“œë¡œ ì•Œë¦½ë‹ˆë‹¤.

---

## 3. ë‚˜ë§Œì˜ ì „ëµ ë§Œë“¤ê¸°

### 3.1 ì „ëµ í…œí”Œë¦¿
ëª¨ë“  ì „ëµì€ `BaseStrategy`ë¥¼ ìƒì†ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.

```python
from hantubot.strategies.base_strategy import BaseStrategy

class MyStrategy(BaseStrategy):
    async def generate_signal(self, data_payload, portfolio):
        signals = []
        
        # ì—¬ê¸°ì— ë§¤ë§¤ ë¡œì§ ì‘ì„±
        # 1. ë°ì´í„° ì¡°íšŒ
        # 2. ì¡°ê±´ ê²€ì‚¬
        # 3. ì‹ í˜¸ ìƒì„± (signals.append(...))
        
        return signals
```

### 3.2 ì˜ˆì œ: ê°€ê²© ëŒíŒŒ ì „ëµ
íŠ¹ì • ê°€ê²©ì„ ë„˜ìœ¼ë©´ ë§¤ìˆ˜í•˜ëŠ” ê°„ë‹¨í•œ ì „ëµì…ë‹ˆë‹¤.

```python
    async def generate_signal(self, data_payload, portfolio):
        signals = []
        target_symbol = "005930"  # ì‚¼ì„±ì „ì
        target_price = 70000      # ëª©í‘œê°€
        
        current_price = self.broker.get_current_price(target_symbol)
        
        # í˜„ì¬ê°€ê°€ ëª©í‘œê°€ë³´ë‹¤ ë†’ê³ , ì•„ì§ ì•ˆ ìƒ€ìœ¼ë©´ ë§¤ìˆ˜
        if current_price >= target_price:
            signals.append({
                'strategy_id': self.strategy_id,
                'symbol': target_symbol,
                'side': 'buy',
                'quantity': 10,
                'order_type': 'market'
            })
            
        return signals
```

### 3.3 ì „ëµ ë“±ë¡
ì‘ì„±í•œ ì „ëµ íŒŒì¼ì„ `hantubot/strategies/` í´ë”ì— ë„£ê³ , `config.yaml`ì— ë“±ë¡í•˜ë©´ ì‹¤í–‰ë©ë‹ˆë‹¤. (ìƒì„¸ êµ¬í˜„ í•„ìš”)
